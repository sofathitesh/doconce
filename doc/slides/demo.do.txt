TITLE: On Schemes for Exponential Decay
AUTHOR: Hans Petter Langtangen at Center for Biomedical Computing, Simula Research Laboratory and Department of Informatics, University of Oslo
DATE: today

# !split indicates where to split the slides

!split

# Headings have 5 = for h3/subsection and 7 = for h1/section
===== Goal =====

The primary goal of this demo talk is to demonstrate how to write
talks with doconce and get them rendered in numerous HTML formats.

The talk investigates the accuracy of three finite difference
schemes for the ordinary differential equation $u'=-au$ with the
aid of numerical experiments. Numerical artifacts are in particular
demonstrated.


!split
======= Mathematical problem =======

# latex blocks are surrounded by !bt and !et

!bt
\begin{align}
u'(t) &= -au(t), \quad t \in (0,T],
label{ode}\\
u(0)  &= I,
label{initial:value}
\end{align}
!et

where

 * $a$, $I$, and $T$ are prescribed parameters
 * $u(t)$ is the unknown function

!split
======= Numerical solution method =======

# !bpop and !epop surround elements that are to pop up
# as we progress in the slide show
# They will often not work if there is code inside

!bpop
 * Mesh in time: $0= t_0< t_1 \cdots < t_N=T$
 * Assume constant $\Delta t = t_{n}-t_{n-1}$
 * $u^n$: numerical approx to the exact solution at $t_n$
!epop

!bpop
Numerical scheme:
!bt
   \[
   u^{n+1} = \frac{1 - (1-\theta) a\Delta t}{1 + \theta a\Delta t}u^n,
   \quad n=0,1,\ldots,N-1
   \]
!et
!epop

!split
# Next: exemplify copying code from file

======= Implementation =======

The numerical method is implemented in a Python function:

@@@CODE src/dc_mod.py  fromto: def solver@def verify_three

!split
===== The Crank-Nicolson method =====

# Figures do not need extension - the right version is picked

FIGURE: [fig/CN, width=600]

!split
===== The artifacts can be explained by some theory =====

!bpop
Exact solution of the scheme:

!bt
\[ u^n = A^n,\quad A = \frac{1 - (1-\theta) a\Delta t}{1 + \theta a\Delta t}\thinspace .\]
!et
!epop

!bpop
 * Stability: $|A| < 1$
 * No oscillations: $A>0$
 * Always for Backward Euler ($\theta=1$)
 * $\Delta t < 1/a$ for Forward Euler ($\theta=0$)
 * $\Delta t < 2/a$ for Crank-Nicolson ($\theta=1/2$)
!epop

