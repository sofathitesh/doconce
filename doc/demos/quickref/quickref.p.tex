%%
%% Automatically generated ptex2tex (extended LaTeX) file
%% from Doconce source
%% http://code.google.com/p/doconce/
%%

% #ifdef BOOK
\documentclass{book}
% #else
\documentclass{article}
% #endif

\usepackage{relsize,epsfig,makeidx,amsmath,amsfonts}
\usepackage[latin1]{inputenc}
\usepackage{ptex2tex}
% #ifdef MOVIE15
\usepackage{movie15}
% #endif
% #ifdef MINTED
\usepackage{minted}  % requires latex -shell-escape (for Minted_* ptex2tex envirs)
% #endif

% #ifdef HELVETICA
% Set helvetica as the default font family:
\RequirePackage{helvet}
\renewcommand\familydefault{phv}
% #endif

\usepackage[%
colorlinks=true,
linkcolor=blue,
citecolor=black,
filecolor=blue,
urlcolor=blue]{hyperref}
%\hyperbaseurl{}   % hyperlinks are relative to this root

\newcommand{\inlinecomment}[2]{  ({\bf #1}: \emph{#2})  }
%\newcommand{\inlinecomment}[2]{}  % turn off inline comments

\makeindex

\begin{document}



% #ifndef LATEX_HEADING
% #define LATEX_HEADING
% #endif

% ----------------- Title -------------------------
% #if LATEX_HEADING == "traditional"

\title{Doconce Quick Reference}

% #elif LATEX_HEADING == "titlepage"

\thispagestyle{empty}
\hbox{\ \ }
\vfill
\begin{center}
{\huge{\bfseries{Doconce Quick Reference}}}

% #else

\begin{center}
{\LARGE\bf Doconce Quick Reference}
\end{center}

% #endif



% ----------------- Author(s) -------------------------
% #if LATEX_HEADING == "traditional"
\author{Hans Petter Langtangen\footnote{Simula Research Laboratory and University of Oslo.}}

% #elif LATEX_HEADING == "titlepage"
\vspace{1.3cm}

{\Large\textsf{Hans Petter Langtangen${}^{1, 2}$}}\\ [3mm]

\ \\ [2mm]

{\large\textsf{${}^1$Simula Research Laboratory} \\ [1.5mm]}
{\large\textsf{${}^2$University of Oslo} \\ [1.5mm]}

% #else

\begin{center}
{\bf Hans Petter Langtangen${}^{1, 2}$} \\ [0mm]
\end{center}

\begin{center}
% List of all institutions:
\centerline{{\small ${}^1$Simula Research Laboratory}}
\centerline{{\small ${}^2$University of Oslo}}
\end{center}
% #endif
% ----------------- End of author(s) -------------------------



% ----------------- Date -------------------------

% #if LATEX_HEADING == "traditional"

\date{Jun 23, 2012}
\maketitle

% #elif LATEX_HEADING == "titlepage"

\ \\ [10mm]
{\large\textsf{Jun 23, 2012}}

\end{center}
\vfill
\clearpage

% #else

\begin{center}
Jun 23, 2012
\end{center}

% #endif

% Very preliminary

\textbf{WARNING: This quick reference is very incomplete!}

\subsection{Supported Formats}

Doconce currently translates files to the following formats:

\begin{itemize}
 \item {\LaTeX} (format \code{latex})

 \item HTML (format \code{html})

 \item reStructuredText (format \code{rst})

 \item StructuredText (format \code{st})

 \item plain (untagged) ASCII (format \code{plain})

 \item Sphinx (format \code{sphinx})

 \item Googlecode wiki (format \code{gwiki})

 \item MediaWiki, a la Wikipedia and Wikibooks (format \code{mwiki})

 \item Creoloe wiki (format \code{cwiki})

 \item Epydoc (format \code{epydoc})

 \item Pandoc (format \code{pandoc}, very experimental)
\end{itemize}

\noindent
The best supported formats are \code{latex}, \code{sphinx}, \code{html}, and \code{plain}.

\subsection{Title, Authors, and Date}

A typical example of giving a title, a set of authors, and a date
reads
\bccq
TITLE: On an Ultimate Markup Language
AUTHOR: H. P. Langtangen at Center for Biomedical Computing, Simula Research Laboratory and Dept. of Informatics, Univ. of Oslo
AUTHOR: Kaare Dump Email: dump@cyb.space.com at Segfault, Cyberspace Inc.
AUTHOR: A. Dummy Author
DATE: today
\eccq
The title must appear on a single line.
The author syntax is
\bccq
name Email: somename@adr.net at institution1 and institution2
\eccq
where the email is optional, the "at" keyword is required if one or
more institutions are to be specified, and the "and" keyword
separates the institutions. Each author specification must appear
on a single line.
When more than one author belong to the
same institution, make sure that the institution is specified in an identical
way for each author.

The date can be set as any text different from \code{today} if not the
current date is wanted, e.g., \code{Feb 22, 2016}.

\subsection{Section Types}

\label{quick:sections}


\begin{quote}\begin{tabular}{ll}
\hline
\multicolumn{1}{c}{Section type} & \multicolumn{1}{c}{Syntax} \\
\hline
chapter                              & \code{========= Heading ========} (9 \code{=}) \\
section                              & \code{======= Heading =======}    (7 \code{=}) \\
subsection                           & \code{===== Heading =====}        (5 \code{=}) \\
subsubsection                        & \code{=== Heading ===}            (3 \code{=}) \\
paragraph                            & \code{__Heading.__}               (2 \code{_}) \\
abstract                             & \code{__Abstract.__} Running text...      \\
\hline
\end{tabular}\end{quote}

\noindent
Note that abstracts are recognized by starting with \code{__Abstract.__} at
the beginning of a line and ending with three or more \code{=} signs of the
next heading.

\subsection{Inline Formatting}

Words surrounded by \code{*} are emphasized: \code{*emphasized words*} becomes
\emph{emphasized words}. Similarly, an underscore surrounds words that
appear in boldface: \code{_boldface_} become \textbf{boldface}.

\subsection{Lists}

There are three types of lists: \emph{bullet lists}, where each item starts
with \code{*}, \emph{enumeration lists}, where each item starts with \code{o} and gets
consqutive numbers,
and \emph{description} lists, where each item starts with \code{-} followed
by a keyword and a colon.
\bccq
Here is a bullet list:

 * item1
 * item2
  * subitem1 of item2
  * subitem2 of item2
 * item3

Note that sublists are consistently indented by one or more blanks..
Here is an enumeration list:

 o item1
 o item2
   may appear on
   multiple lines
  o subitem1 of item2
  o subitem2 of item2
 o item3

And finally a description list:

 - keyword1: followed by
   some text
   over multiple
   lines
 - keyword2:
   followed by text on the next line
 - keyword3: and its description may fit on one line
\eccq
The code above follows.

Here is a bullet list:

\begin{itemize}
 \item item1

 \item item2
\begin{itemize}

  \item subitem1 of item2

  \item subitem2 of item2

\end{itemize}

\noindent
 \item item3
\end{itemize}

\noindent
Note that sublists are indented.
Here is an enumeration list:

\begin{enumerate}
\item item1

\item item2
   may appear on
   multiple lines
\begin{enumerate}

 \item subitem1 of item2

 \item subitem2 of item2

\end{enumerate}

\noindent
\item item3
\end{enumerate}

\noindent
And finally a description list:

\begin{description}
 \item[keyword1:] 
   followed by
   some text
   over multiple
   lines

 \item[keyword2:] 
   followed by text on the next line

 \item[keyword3:] 
   and its description may fit on one line
\end{description}

\noindent

\subsection{Comments}

Lines starting with \code{#} are treated as comments in the document
and translated to the proper syntax for comments in
the output document. Such comment lines
should not appear before {\LaTeX} math blocks, verbatim code blocks,
or lists if the formats \code{rst} and \code{sphinx} are desired.

When using the Mako preprocessor one can also place comments in
the Doconce source file that will be removed by Mako before
Doconce starts processing the file. Mako comments are recognized
by lines starting with two hashes \code{##} or by blocks of text
inside the comment directives \code{%<doc>} (beginning) and \code{<%doc/>} (end).

Inline comments, in the text, that are meant as messages or notes to readers
(authors in particular)
are often useful and enabled by the syntax
\bccq
[name: running text]
\eccq
where \code{name} is the name or ID of an author or reader making the comment,
and \code{running text} is the comment. There must be a space after the colon.
Running
\bsys
doconce format html mydoc.do.txt --skip_inline_comments
\esys
removes all such inline comments from the output. This feature makes it easy
to turn on and off notes to readers and is frequently used while writing
a document.

All inline comments to readers can also be physically
removed from the Doconce source if desired:
\bsys
doconce remove_inline_comments mydoc.do.txt
\esys
This action is appropriate when all issues with such comments are resolved.

\subsection{Verbatim/Computer Code}

Inline verbatim code is typeset within single backquotes, as in
\bccq
Some sentence with `words in verbatim style`.
\eccq
resulting in Some sentence with \code{words in verbatim style}.

Multi-line blocks of verbatim text, typically computer code, is typeset
in between \code{!bc xxx} and \code{!ec} directives (which must appear on the
beginning of the line). A specification \code{xxx} indicates what verbatim
formatting style that is to be used. Typical values for \code{xxx} are
nothing, \code{cod} for a code snippet, \code{pro} for a complete program,
\code{sys} for a terminal session, \code{dat} for a data file (or output from a
program),
\code{Xpro} or \code{Xcod} for a program or code snipped, respectively,
in programming \code{X}, where \code{X} may be \code{py} for Python,
\code{cy} for Cython, \code{sh} for Bash or other Unix shells,
\code{f} for Fortran, \code{c} for C, \code{cpp} for C++, \code{m} for MATLAB,
\code{pl} for Perl. For output in \code{latex} one can let \code{xxx} reflect any
defined verbatim environment in the \code{ptex2tex} configuration file
(\code{.ptex2tex.cfg}). For \code{sphinx} output one can insert a comment
\bccq
# sphinx code-blocks: pycod=python cod=fortran cppcod=c++ sys=console
\eccq
that maps environments (\code{xxx}) onto valid language types for
Pygments (which is what \code{sphinx} applies to typeset computer code).

The \code{xxx} specifier has only effect for \code{latex} and
\code{sphinx} output. All other formats use a fixed monospace font for all
kinds of verbatim output.

% When showing copy from file in !bc envir, intent a character - otherwise
% ptex2tex is confused and starts copying...
Computer code can also be copied from a file:
\bccq
 @@@CODE doconce_program.sh
 @@@CODE doconce_program.sh  fromto: doconce clean@^doconce split_rst
 @@@CODE doconce_program.sh  from-to: doconce clean@^doconce split_rst
\eccq
The \code{@@@CODE} identifier must appear at the very beginning of the line.
The first specification copies the complete file \code{doconce_program.sh}.
The second specification copies from the first line matching the \emph{regular
expression} \code{doconce clean} up to, but not including the line
matching the \emph{regular expression} \code{^doconce split_rst}.
The third specification behaves as the second, but the line matching
the first regular expression is not copied (aimed at copying
text between begin-end comment pair in the file).

The copied line from file are in this example put inside \code{!bc shpro}
and \code{!ec} directives, if a complete file is copied, while the
directives become \code{!bc shcod} and \code{!ec} when a code snippet is copied
from file. In general, for a filename extension \code{.X}, the environment
becomes \code{!bc Xpro} or \code{!bc Xcod} for a complete program or snippet,
respectively. The enivorments (\code{Xcod} and \code{Xpro}) are only active
for \code{latex} and \code{sphinx} outout.

Important warnings:

\begin{itemize}
 \item A code block must come after some plain sentence (at least for successful
   output in reStructredText), not directly after a section/paragraph heading,
   table, comment, figure, or movie.

 \item Verbatim code blocks inside lists can be ugly typeset in some
   output formats. A more robust approach is to replace the list by
   paragraphs with headings.
\end{itemize}

\noindent

\subsection{{\LaTeX} Mathematics}

Doconce supports inline mathematics and blocks of mathematics, using
standard {\LaTeX} syntax. The output formats \code{sphinx}, \code{latex}, and \code{pdflatex}
work with this syntax while all other formats will just display the
raw {\LaTeX} code.

Inline expressions are written in the standard
{\LaTeX} way with the mathematics surrounded by dollar signs, as in
$Ax=b$. To help increase readability in other formats than \code{sphinx},
\code{latex}, and \code{pdflatex}, inline mathematics may have a more human
readable companion expression. The syntax is like
\bccq
$\sin(\norm{\bf u})$|$sin(||u||)$
\eccq
That is, the {\LaTeX} expression appears to the left of a vertical bar (pipe
symbol) and the more readable expression appears to the right. Both
expressions are surrounded by dollar signs. Plain text formats and HTML
will applied the expression to the right.

Blocks of {\LaTeX} mathematics are written within
\code{!bt}
and
\code{!et} ("begin/end TeX") directives, just like computer code.
For example,
\bccq
\begin{align*}
\nabla\cdot u &= 0,\\
\nabla\times u & 0.
\end{align*}
\eccq
will appear as
\begin{align*}
\nabla\cdot u &= 0,\\
\nabla\times u & 0.
\end{align*}

One can use \code{#if FORMAT in ("latex", "pdflatex", "sphinx", "mwiki")} to let
the preprocessor choose a block of mathematics in {\LaTeX} format
or (\code{#else}) a modified form more suited for plain text and wiki
formats without support for mathematics.

Any {\LaTeX} syntax is accepted, but if output in the \code{sphinx} format
is important, one must know that \code{sphinx} does not support many
{\LaTeX} constructs. For output both in \code{latex} and \code{sphinx} formats we
recommend the following:

\begin{itemize}
  \item Use only the equation environments \code{\[}, \code{\]},
    \code{equation}, \code{equation*}, \code{align}, and \code{align*}.

  \item Labels in multiple equation environments such as \code{align} are
    not (yet) handled by \code{sphinx}, so avoid inserting labels and referring
    to equation labels in \code{align} environments. Actually, \code{align*}
    is the preferred environment for multiple equations. Writing with
    also \code{sphinx} output in mind results in a slightly adjusted type
    of {\LaTeX} writing.

  \item {\LaTeX} supports lots of fancy formatting, for example, multiple
    plots in the same figure, footnotes, margin notes, etc.
    Allowing other output formats, such as \code{sphinx}, makes it necessary
    to only utilze very standard {\LaTeX} and avoid, for instance, more than
    one plot per figure. However, one can use preprocessor if-tests on
    the format (typically \code{# #ifdef format == "latex"}) to
    include special code for \code{latex} output and more straightforward
    typesetting for other formats. In this way, one can also allow
    advanced {\LaTeX} features and fine tuning of resulting PDF document.
\end{itemize}

\noindent
\paragraph{LaTeX Newcommands.}
Text missing...

\subsection{Figures and Movies}

Figures and movies have almost equal syntax:
\bccq
FIGURE: [relative/path/to/figurefile, width=500] Here goes the caption which must be on a single line. label{some:fig:label}

MOVIE: [relative/path/to/moviefile, width=500] Here goes the caption which must be on a single line. label{some:fig:label}
\eccq
Note the mandatory comma after the figure/movie file.

The figure file can be listed without extension. Doconce will then find
the version of the file with the most appropriate extension for the chosen
output format. If not suitable version is found, Doconce will convert
another format to the desired one.

Movie files can either be a video or a wildcard expression for a
series of frames. In the latter case, a simple device in an HTML page
will display the individual frame files as a movie.

Combining several image files into one can be done by the
\code{convert} and \code{montage} programs from the ImageMagick suite:
\bsys
montage file1.png file2.png ... file4.png -geometry +2+2  result.png
montage file1.png file2.png -tile x1 result.png
montage file1.png file2.png -tile 1x result.png

convert -background white file1.png file2.png +append tmp.png
\esys
Use \code{+append} for stacking left to right, \code{-append} for top to bottom.
The positioning of the figures can be controlled by \code{-gravity}.

\subsection{Tables}

The table in Section~\ref{quick:sections} was written with this
syntax:
\bccq
|----------------c--------|------------------c--------------------|
|      Section type       |        Syntax                         |
|----------------l--------|------------------l--------------------|
| chapter                 | `========= Heading ========` (9 `=`)  |
| section                 | `======= Heading =======`    (7 `=`)  |
| subsection              | `===== Heading =====`        (5 `=`)  |
| subsubsection           | `=== Heading ===`            (3 `=`)  |
| paragraph               | `__Heading.__`               (2 `_`)  |
|-----------------------------------------------------------------|
\eccq

Note that

\begin{itemize}
 \item Each line begins and ends with a vertical bar (pipe symbol).

 \item Column data are separated by a vertical bar (pipe symbol).

 \item There may be horizontal rules, i.e., lines with dashes for
   indicating the heading and the end of the table, and these may
   contain characters 'c', 'l', or 'r' for how to align headings or
   columns. The first horizontal rule may indicate how to align
   headings (center, left, right), and the horizontal rule after the
   heading line may indicate how to align the data in the columns
   (center, left, right).

 \item If the horizontal rules are without alignment information there should
   be no vertical bar (pipe symbol) between the columns. Otherwise, such
   a bar indicates a vertical bar between columns in {\LaTeX}.

 \item Many output formats are so primitive that heading and column alignment
   have no effect.
\end{itemize}

\noindent

\subsection{Labels, References, Citations, and Index}

The notion of labels, references, citations, and an index is adopted
from {\LaTeX} with a very similar syntax. As in {\LaTeX}, a label can be
inserted anywhere, using the syntax
\bccq
label{name}
\eccq
with no backslash
preceding the label keyword! It is common practice to choose \code{name}
as some hierarchical name, say \code{a:b:c}, where \code{a} and \code{b} indicate
some abbreviations for a section and/or subsection for the topic and
\code{c} is some name for the particular unit that has a label.

A reference to the label \code{name} is written as
\bccq
ref{name}
\eccq
again with no backslash before \code{ref}.

Single citations are written as
\bccq
cite{name}
\eccq
where \code{name} is a logical name
of the reference (again, {\LaTeX} writers must not insert a backslash).
Bibliography citations often have \code{name} on the form
\code{Author1_Author2_YYYY}, \code{Author_YYYY}, or \code{Author1_etal_YYYY}, where
\code{YYYY} is the year of the publication.
Multiple citations at once is possible by separating the logical names
by comma:
\bccq
cite{name1,name2,name3}
\eccq

The bibliography is specified by a line \code{BIBFILE: name_bib.bib,
name_bib.rst, name_bib.py}, where \code{name} is the logical name of the
document (the doconce file will then normally have the name
\code{name.do.txt}), and the various files reflect different formattings of
the bibliography: '.bib' indicates a BibTeX file, '.rst' a reST-style
bibliography, and '.py' a Python list of dictionaries for specifying
the entries in the bibliography. The bibliography (as read from file)
is inserted where the \code{BIBFILE} keyword appears.

Doconce supports creating an index of keywords. A certain keyword
is registered for the index by a syntax like (no
backslash!)
\bccq
index{name}
\eccq
It is recommended to place any index of this type outside
running text, i.e., after (sub)section titles and in the space between
paragraphs. Index specifications placed right before paragraphs also
gives the doconce source code an indication of the content in the
forthcoming text. The index is only produced for the \code{latex}, \code{rst}, and
\code{sphinx} formats.

\subsection{Capabilities of the "doconce" Program}

The \code{doconce} program can be used for a number of purposes besides
transforming a \code{.do.txt} file to some format. Here is the
list of capabilities:

\bshpro
Usage: doconce command [optional arguments]
commands: format insertdocstr old2new_format gwiki_figsubst remove_inline_comments latin2html sphinx_dir subst replace replace_from_file clean help latex_header latex_footer guess_encoding change_encoding bbl2rst split_rst list_labels teamod sphinxfix_localURLs make_figure_code_links grab spellcheck ptex2tex

doconce format html|latex|pdflatex|rst|sphinx|plain|gwiki|mwiki|cwiki|pandoc|st|epytext file.do.txt

doconce subst [-s -m -x --restore] regex-pattern regex-replacement file1 file2 ...
(-s is the re.DOTALL modifier, -m is the re.MULTILINE modifier,
 -x is the re.VERBOSE modifier, --restore copies backup files back again)

doconce replace from-text to-text file1 file2 ...
(exact text substutition)

doconce replace_from_file file-with-from-to file1 file2 ...
(exact text substitution, but a set of from-to relations)

doconce gwiki_figsubst file.gwiki URL-of-fig-dir

doconce remove_inline_comments file.do.txt

doconce sphinx_dir author='Me and you' title='Quick title' \
    version=0.1 dirname=sphinx-rootdir theme=default \
    file1 file2 file3
(requires sphinx version >= 1.1)

doconce latin2html file.html

doconce insertdocstr rootdir

doconce clean
(remove all files that the doconce format can regenerate)

doconce latex_header
doconce latex_footer

doconce change_encoding utf-8 latin1 filename
doconce guess_encoding filename

doconce bbl2rst file.bbl
doconce split_rst complete_file.rst
doconce sphinxfix_local_URLs file.rst

doconce grab --from[-] from-text [--to[-] to-text] somefile
doconce spellcheck -d .dict4spell.txt *.do.txt
doconce ptex2tex mydoc -DMINTED pycod=minted sys=Verbatim \
        dat=\begin{quote}\begin{verbatim};\end{verbatim}\end{quote}

doconce list_labels doconcefile.do.txt | latexfile.tex
doconce teamod name
doconce assemble name master.do.txt
\eshpro

\subsection{Exercises}

Doconce supports \emph{Exercise}, \emph{Problem}, and \emph{Project}. These are typeset
as ordinary sections and referred to by their section labels.
The typical sketch of an exercise, problem, or project sections
looks as follows:
\bccq
===== Problem: Derive the Formula for the Area of an Ellipse =====
label{problem:ellipsearea1}
file=ellipse_area.pdf
solution=ellipse_area1_sol.pdf

Derive an expression for the area of an ellipse by integrating
the area under a curve that defines half of the allipse.
Show each step in the mathematical derivation.

__Hint 1.__ Wikipedia has the formula for the curve.

__Hint 2.__ "Wolframalpha": "http://wolframalpha.com" can perhaps
compute the integral.
\eccq
An exercise, problem, or project has certain elements:

\begin{itemize}
  \item A headline at the level of a subsection or subsubsection,
    containing one of the words "Exercise:", "Problem:", or
    "Project:", followed by a title. (Required.)

  \item A standard label for referring to the exercise. (Optional.)

  \item A name for the file with the result/answer (\code{file=filename}). (Optional.)

  \item A name for the solution file (\code{solution=filename}), where the file
    name may be a URL. (Optional.)

  \item The running text of the exercise. (Required.)

  \item A sequence of hints, indicated as paragraphs. There can be a
    single hint, without any number, or several numbered hints.
    (Optional.)
\end{itemize}

\noindent

\subsection{Labels, Index, and Citations}

\subsection{Preprocessing}

Doconce documents may utilize a preprocessor, either \code{preprocess} or
\code{mako}. The former is a C-style preprocessor that allows if-tests
and including other files (but not macros with arguments).
The \code{mako} preprocessor is much more advanced - it is actually a full
programming language, very similar to Python.

\printindex

\end{document}
